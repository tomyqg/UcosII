#include "display.h"


u8 const zku[512]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1C,0x00,
0x00,0x00,0x00,0x00,0x00,0x80,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0x7F,0x00,
0x00,0x00,0x00,0x00,0xF0,0xFF,0xFF,0x00,0x00,0x00,0x00,0xF0,0xFF,0xFF,0x00,0x00,
0x00,0x00,0xFC,0xFF,0x0F,0x80,0x00,0x00,0x00,0xFC,0x3F,0x10,0x00,0x80,0x03,0x00,
0x00,0x00,0x00,0x60,0x00,0x80,0x07,0x00,0x00,0x00,0x03,0xC0,0x00,0xC0,0x0F,0x00,
0x00,0x00,0x06,0xC0,0x01,0xC0,0x03,0x00,0x00,0x00,0x1E,0x80,0x07,0xE0,0x01,0x00,
0x00,0x00,0x3C,0x80,0x0F,0xE0,0x00,0x00,0x00,0x00,0x78,0x00,0x0F,0xF0,0x00,0x00,
0x00,0x00,0x78,0x00,0x0F,0x70,0x00,0x00,0x00,0x00,0x78,0x00,0x0E,0x38,0x00,0x00,
0x00,0x00,0x70,0x00,0x0E,0x18,0x00,0x00,0x00,0x04,0x70,0x00,0x06,0x0C,0x80,0x00,
0x00,0x04,0x20,0x00,0x00,0x06,0xC0,0x01,0x00,0x06,0x00,0x00,0x00,0x00,0xE0,0x03,
0x00,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0x07,0x00,0x06,0x00,0x00,0x00,0x00,0xE0,0x07,
0x00,0x07,0x00,0x02,0x00,0x00,0xE0,0x01,0x80,0x07,0x00,0x0E,0x00,0x00,0x70,0x00,
0x80,0x07,0x00,0x3E,0x00,0x00,0x30,0x00,0xE0,0x07,0x00,0x3E,0x00,0x00,0x18,0x00,
0xE0,0x03,0x00,0x1E,0x00,0x00,0x08,0x00,0xE0,0x01,0x00,0x1E,0x00,0x00,0x08,0x00,
0x00,0x00,0x00,0x1E,0x00,0x00,0x06,0x00,0x00,0x00,0x00,0x1E,0x00,0x00,0x0F,0x00,
0x00,0xFE,0xFF,0xFF,0xFF,0xFF,0x1F,0x00,0x00,0xFC,0xFF,0xFF,0xFF,0xFF,0x3F,0x00,
0x00,0x08,0x00,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x07,0x00,0xC0,0x00,0x00,
0x00,0x00,0x80,0x07,0x00,0xE0,0x01,0x00,0x00,0x00,0x80,0xFF,0xFF,0xFF,0x03,0x00,
0x00,0x00,0xC0,0xFF,0xFF,0xFF,0x07,0x00,0x00,0x00,0xC0,0x09,0x00,0xF0,0x01,0x00,
0x00,0x00,0xE0,0x19,0x00,0xF8,0x00,0x00,0x00,0x00,0xE0,0x30,0x00,0x7C,0x00,0x00,
0x00,0x00,0xF0,0x30,0x00,0x3E,0x00,0x00,0x00,0x00,0x78,0x60,0x00,0x1E,0x00,0x00,
0x00,0x00,0x38,0xC0,0x00,0x0F,0x00,0x00,0x00,0x00,0x3C,0xC0,0x81,0x07,0x00,0x00,
0x00,0x00,0x1E,0x80,0xC7,0x03,0x00,0x00,0x00,0x00,0x0F,0x00,0xEF,0x01,0x00,0x00,
0x00,0x80,0x07,0x00,0xFE,0x00,0x00,0x00,0x00,0x80,0x03,0x00,0x7C,0x00,0x00,0x00,
0x00,0xC0,0x01,0x00,0xFE,0x01,0x00,0x00,0x00,0xF0,0x00,0x80,0xEF,0x0F,0x00,0x00,
0x00,0x38,0x00,0xE0,0x87,0x7F,0x00,0x00,0x00,0x1C,0x00,0xF8,0x01,0xFE,0x1F,0x00,
0x00,0x0E,0x00,0x7E,0x00,0xF8,0xFF,0x1F,0x00,0x03,0xC0,0x0F,0x00,0xC0,0xFF,0x07,
0xC0,0x00,0xF8,0x01,0x00,0x00,0xFE,0x03,0x00,0x80,0x1F,0x00,0x00,0x00,0xE0,0x01,
0x00,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"爱",0*/

};/*"爱",0*/



/*******************************************
*函数名称:
*函数描述:
*输入参数:
*返回参数
*******************************************/
void Display_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStructure;
  RCC_APB2PeriphClockCmd(RCC_APB2Periph_AFIO |RCC_APB2Periph_GPIOB|RCC_APB2Periph_GPIOC, ENABLE);	//使能GPIOB时钟
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0|GPIO_Pin_1|GPIO_Pin_4|GPIO_Pin_5|GPIO_Pin_6|GPIO_Pin_7|GPIO_Pin_8|GPIO_Pin_9|GPIO_Pin_10|GPIO_Pin_11|GPIO_Pin_12|GPIO_Pin_13|GPIO_Pin_14|GPIO_Pin_15;
  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;	
  GPIO_Init(GPIOB, &GPIO_InitStructure);   
    
  GPIO_InitStructure.GPIO_Pin =GPIO_Pin_6|GPIO_Pin_7|GPIO_Pin_8|GPIO_Pin_2|GPIO_Pin_3|GPIO_Pin_10; 
  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;	
  GPIO_Init(GPIOC, &GPIO_InitStructure);   
}

/*******************************************
*函数名称:
*函数描述:
*输入参数:
*返回参数
*******************************************/
void Display_init(void)
{
  Display_GPIO_Init();
}



/*******************************************
*函数名称:
*函数描述:
*输入参数:
*返回参数
*******************************************/
void Display_Line(unsigned char line)
{
   switch(line)
   {
    case 0 :D=0;C=0;B=0;A=0; break;
    case 1 :D=0;C=0;B=0;A=1; break;
    case 2 :D=0;C=0;B=1;A=0; break;
    case 3 :D=0;C=0;B=1;A=1; break;
    case 4 :D=0;C=1;B=0;A=0; break;
    case 5 :D=0;C=1;B=0;A=1; break;
    case 6 :D=0;C=1;B=1;A=0; break;
    case 7 :D=0;C=1;B=1;A=1; break;
    case 8 :D=1;C=0;B=0;A=0; break;
    case 9 :D=1;C=0;B=0;A=1; break;
    case 10:D=1;C=0;B=1;A=0; break;
    case 11:D=1;C=0;B=1;A=1; break;
    case 12:D=1;C=1;B=0;A=0; break;
    case 13:D=1;C=1;B=0;A=1; break;
    case 14:D=1;C=1;B=1;A=0; break;
    case 15:D=1;C=1;B=1;A=1; break;
        
   
    case 16:D=0;C=0;B=0;A=0; break;
    case 17:D=0;C=0;B=0;A=1; break;
    case 18:D=0;C=0;B=1;A=0; break;
    case 19:D=0;C=0;B=1;A=1; break;
    case 20:D=0;C=1;B=0;A=0; break;
    case 21:D=0;C=1;B=0;A=1; break;
    case 22:D=0;C=1;B=1;A=0; break;
    case 23:D=0;C=1;B=1;A=1; break;
    case 24:D=1;C=0;B=0;A=0; break;
    case 25:D=1;C=0;B=0;A=1; break;
    case 26:D=1;C=0;B=1;A=0; break;
    case 27:D=1;C=0;B=1;A=1; break;
    case 28:D=1;C=1;B=0;A=0; break;
    case 29:D=1;C=1;B=0;A=1; break;
    case 30:D=1;C=1;B=1;A=0; break;
    case 31:D=1;C=1;B=1;A=1; break;
    
    case 32:D=0;C=0;B=0;A=0; break;
    case 33:D=0;C=0;B=0;A=1; break;
    case 34:D=0;C=0;B=1;A=0; break;
    case 35:D=0;C=0;B=1;A=1; break;
    case 36:D=0;C=1;B=0;A=0; break;
    case 37:D=0;C=1;B=0;A=1; break;
    case 38:D=0;C=1;B=1;A=0; break;
    case 39:D=0;C=1;B=1;A=1; break;
    case 40:D=1;C=0;B=0;A=0; break;
    case 41:D=1;C=0;B=0;A=1; break;
    case 42:D=1;C=0;B=1;A=0; break;
    case 43:D=1;C=0;B=1;A=1; break;
    case 44:D=1;C=1;B=0;A=0; break;
    case 45:D=1;C=1;B=0;A=1; break;
    case 46:D=1;C=1;B=1;A=0; break;
    case 47:D=1;C=1;B=1;A=1; break;
    
    case 48:D=0;C=0;B=0;A=0; break;
    case 49:D=0;C=0;B=0;A=1; break;
    case 50:D=0;C=0;B=1;A=0; break;
    case 51:D=0;C=0;B=1;A=1; break;
    case 52:D=0;C=1;B=0;A=0; break;
    case 53:D=0;C=1;B=0;A=1; break;
    case 54:D=0;C=1;B=1;A=0; break;
    case 55:D=0;C=1;B=1;A=1; break;
    case 56:D=1;C=0;B=0;A=0; break;
    case 57:D=1;C=0;B=0;A=1; break;
    case 58:D=1;C=0;B=1;A=0; break;
    case 59:D=1;C=0;B=1;A=1; break;
    case 60:D=1;C=1;B=0;A=0; break;
    case 61:D=1;C=1;B=0;A=1; break;
    case 62:D=1;C=1;B=1;A=0; break;
    case 63:D=1;C=1;B=1;A=1; break;
    
    default : break;
   }
}

void Display_RGB(u8 line,u8 RK,u8 GK,u8 BK)
{
  if(line<16)
  {
      R1=RK;B1=BK;G1=GK;
  }
  else if(line<32)
  {
      R2=RK;B2=BK;G2=GK;
  }

  else if(line<48)
  {
      R3=RK;B3=BK;G3=GK;
  }

  else
  {
      R4=RK;B4=BK;G4=GK;
  }

}

void Display_RGB_Clear(void)
{
    R1=0;B1=0;G1=0;
    R2=0;B2=0;G2=0;
    R3=0;B3=0;G3=0;
    R4=0;B4=0;G4=0;
}

/*******************************************
*函数名称:void ClearShadow(unsigned char line)
*函数描述:消影函数 防止显示有拖影
*输入参数:无
*返回参数:line (0~63)行
*******************************************/
void ClearShadow(unsigned char line)
{
  unsigned char i=0;
  EN=1;  
  LAT=0;
  
  for(i=0;i<64;i++)
  {
    Display_RGB(line,0,0,0);
    CLK=0;  
    CLK=1;
  }
  
  LAT=0;
  LAT=1;
  EN=0;
}
void Display_test(void)
{
  u32 temp1=0;u32 temp2=0;
  unsigned char i=0,k=0;
  unsigned int p=0;

     for(k=0;k<64;k++)
     {      
        Display_Line(k);
        EN=1;
        LAT=0;
        p=k<<3; //p=k*8;
        temp2=(zku[p+7]<<24) + (zku[p+6]<<16) + (zku[p+5]<<8) + (zku[p+4]<<0);
        temp1=(zku[p+3]<<24) + (zku[p+2]<<16) + (zku[p+1]<<8) + (zku[p+0]<<0);
       
        for(i=0;i<32;i++)
        {
          if(temp1&0x01)
            Display_RGB(k,0,0,1);
          else 
            Display_RGB(k,0,0,0);
          temp1>>=1;
          CLK=0;  
          CLK=1;
        }
         for(i=0;i<32;i++)
        {
          if(temp2&0x01)
            Display_RGB(k,0,0,1);
          else 
            Display_RGB(k,0,0,0);
          temp2>>=1;
          CLK=0;  
          CLK=1;
        }
        
        LAT=0;
        LAT=1;
        EN=0;
        DelayUs(55); 
        //ClearShadow(k);  //消影函数
     }
}




/*******************************************
*函数名称:void Display(u8 *str, u8 RGB)
*函数描述:显示函数
*输入参数: str 字体结构体 RGB色彩
*返回参数: void
*******************************************/
void Display(u8 *str, u8 RGB)
{
   
}

u16 FFT_Value[64];
u16 FFTValue[64];
/*******************************************
*函数名称:void Display_dispose(void)
*函数描述:把FFT的幅值处理成显示的幅值
*输入参数:void
*返回参数:void
*******************************************/
#if 0
void Display_dispose(void)
{
  u16 i=0;
  for(i=0;i<24;i++)
  {
    FFT_Value[i] = FFT_data[i]; 
  }
  for(i=0;i<20;i++)
  {
    FFT_Value[24+i] = FFT_data[24+(i>>1)]; 
  }
  for(i=0;i<20;i++)
  {
    FFT_Value[44+i] = FFT_data[64+(i*3)]; 
  }
  
  for(i=0;i<64;i++)
  {
    if(FFT_Value[i]);
      // FFTValue[i]
  }
}
#endif

/*******************************************
*函数名称:void Display_FFT
*函数描述:显示函数
*输入参数: void
*返回参数: void
*******************************************/
void Display_FFT(void)
{
    u32 temp1=0;u32 temp2=0;
    unsigned char i=0,k=0;
    unsigned int p=0;

     for(k=0;k<64;k++)
     {      
        Display_Line(k);
        EN=1;
        LAT=0;
       
        for(i=0;i<32;i++)
        {
           temp2=(zku[p+7]<<24) + (zku[p+6]<<16) + (zku[p+5]<<8) + (zku[p+4]<<0);
           temp1=(zku[p+3]<<24) + (zku[p+2]<<16) + (zku[p+1]<<8) + (zku[p+0]<<0);     
        }
 
       
        for(i=0;i<32;i++)
        {
          if(temp1&0x01)
            Display_RGB(k,0,1,0);
          else 
            Display_RGB(k,0,0,0);
          temp1>>=1;
          CLK=0;  
          CLK=1;
        }
         for(i=0;i<32;i++)
        {
          if(temp2&0x01)
            Display_RGB(k,0,0,0);
          else 
            Display_RGB(k,0,0,0);
          temp2>>=1;
          CLK=0;  
          CLK=1;
        }
        
        LAT=0;
        LAT=1;
        EN=0;
        DelayUs(100); 
        //ClearShadow(k);  //消影函数
     }  
}





